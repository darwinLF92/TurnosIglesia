{% extends 'aplicacion/base.html' %}
{% load static %}
{% load auth_extras %}
{% block carrusel_fullscreen %}
<link rel="stylesheet" href="https://unpkg.com/swiper@10/swiper-bundle.min.css"/>
<div class="carousel-wrapper">  <!-- OJO: .carousel-wrapper (con punto en CSS) -->
  <div id="carouselExample" class="carousel slide carousel-fade" data-bs-ride="carousel" data-bs-interval="4000" data-bs-pause="false">
    <div class="carousel-inner">
      {% for img in imagenes_presentacion %}
      <div class="carousel-item {% if forloop.first %}active{% endif %}">
        <div class="carousel-background" style="background-image: url('{{ img.imagen.url|urlencode }}');"></div>
        <img src="{{ img.imagen.url|urlencode }}" class="main-carousel-image" alt="{{ img.titulo }}">
        {% if img.titulo %}
          <div class="carousel-caption d-none d-md-block">
            <h5>{{ img.titulo }}</h5>
          </div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Anterior</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Siguiente</span>
    </button>
  </div>
</div>
{% endblock %}

{% block content %}
<!-- Sección de tarjetas -->
<div class="container card-home">
  <div class="feature-swiper-outer">
    <div class="swiper feature-swiper">
      <div class="swiper-wrapper">

      <!-- Slide 1 -->
      <div class="swiper-slide">
        <article class="post-card">
          <div class="post-media">
            <img src="{% static 'home/logo_hermandad.png' %}" alt="¿Quiénes somos?">
          </div>
          <div class="post-body">
            <h3 class="post-title">¿QUIENES SOMOS?</h3>
            <div class="post-meta">
              <span>22 de febrero de 2025</span>
              <span>• Por la Hermandad V.I. Señor Sepultado y V.I. Virgen de Dolores</span>
            </div>
            <p class="post-excerpt">Información sobre nuestra hermandad, visión y valores.</p>
          </div>
          <div class="post-footer">
            <a class="btn btn-verm" href="{% url 'aplicacion:quienes_somos' %}">
              VER MÁS <i class="fa-solid fa-arrow-right-long"></i>
            </a>
          </div>
        </article>
      </div>

      <!-- Slide 2 -->
      <div class="swiper-slide">
        <article class="post-card">
          <div class="post-media">
            <img src="{% static 'home/h_imagenes.png' %}" alt="Historia de nuestras imágenes">
          </div>
          <div class="post-body">
            <h3 class="post-title">UN LEGADO DE FE Y TRADICIÓN</h3>
            <div class="post-meta">
              <span>02 Abril 2020</span>
              <span>• Por la Hermandad V.I. Señor Sepultado y V.I. Virgen de Dolores</span>
            </div>
            <p class="post-excerpt">Descubre la historia detrás de nuestras imágenes religiosas.</p>
          </div>
          <div class="post-footer">
            <a class="btn btn-verm" href="{% url 'aplicacion:historia_imagenes' %}">
              VER MÁS <i class="fa-solid fa-arrow-right-long"></i>
            </a>
          </div>
        </article>
      </div>

      <!-- Slide 3 -->
      <div class="swiper-slide">
        <article class="post-card">
          <div class="post-media">
            <img src="{% static 'home/multimedia.png' %}" alt="Multimedia">
          </div>
          <div class="post-body">
            <h3 class="post-title">PENTAGRAMA FÚNEBRE</h3>
            <div class="post-meta">
              <span>03 Enero 2024</span>
              <span>• por Hermandad</span>
              <span><i class="fa-regular fa-comment"></i> 0</span>
            </div>
            <p class="post-excerpt">Pentagrama Fúnebre, marchas que han marcado historia y que son parte de nuestro sentir, como cucurucho fiel y devoto, cada una de ellas
                transmite emociones y recuerdos imborrables de nuestras queridas imágenes de pasión.
            </p>
          </div>
          <div class="post-footer">
            <a class="btn btn-verm" href="{% url 'aplicacion:lista_marchas' %}">
              EXPLORAR <i class="fa-solid fa-arrow-right-long"></i>
            </a>
          </div>
        </article>
      </div>

      <!-- Agrega más slides (Fototeca, Recorridos, Oraciones) -->
      <div class="swiper-slide">
        <article class="post-card">
          <div class="post-media">
            <img src="{% static 'home/fototeca.png' %}" alt="Fototeca y Video">
          </div>
          <div class="post-body">
            <h3 class="post-title">FOTOTECA Y VIDEO</h3>
            <div class="post-meta"><span>Actualizado</span></div>
            <p class="post-excerpt">Documentación fotográfica y videoclips de nuestras actividades.</p>
          </div>
          <div class="post-footer">
            <a class="btn btn-verm" href="{% url 'aplicacion:galeria' %}">
              VER GALERÍA <i class="fa-solid fa-arrow-right-long"></i>
            </a>
          </div>
        </article>
      </div>

      <div class="swiper-slide">
        <article class="post-card">
          <div class="post-media">
            <img src="{% static 'img/home/recorridos.jpg' %}" alt="Recorridos Procesionales">
          </div>
          <div class="post-body">
            <h3 class="post-title">RECORRIDOS PROCESIONALES</h3>
            <div class="post-meta"><span>Mapa & galería</span></div>
            <p class="post-excerpt">Imágenes e información de los recorridos procesionales.</p>
          </div>
          <div class="post-footer">
            <a class="btn btn-verm" href="#">
              VER RECORRIDOS <i class="fa-solid fa-arrow-right-long"></i>
            </a>
          </div>
        </article>
      </div>

      <div class="swiper-slide">
        <article class="post-card">
          <div class="post-media">
            <img src="{% static 'img/home/oraciones.jpg' %}" alt="Oraciones">
          </div>
          <div class="post-body">
            <h3 class="post-title">ORACIONES</h3>
            <div class="post-meta"><span>Devocionales</span></div>
            <p class="post-excerpt">Imágenes y contenido de oraciones importantes.</p>
          </div>
          <div class="post-footer">
            <a class="btn btn-verm" href="#">
              EXPLORAR <i class="fa-solid fa-arrow-right-long"></i>
            </a>
          </div>
        </article>
      </div>

    </div>
  </div>

    <!-- Flechas y dots -->
    <div class="swiper-button-prev"></div>
    <div class="swiper-button-next"></div>
  </div>
</div>

{% if posts_info %}
<div class="container my-4">
  <div class="row g-4">
    {% for p in posts_info %}
      <div class="col-12 col-md-6">
        <div class="info-card text-center">

          <div class="info-card__title">
            {{ p.nombre_procesion }}
          </div>

          <div class="info-card__divider"></div>

          {% if p.descripcion %}
            <div class="info-card__desc">
              {{ p.descripcion|linebreaksbr }}
            </div>
          {% endif %}

          <div class="info-card__date">
            {% if p.fecha_descriptiva %}
              {{ p.fecha_descriptiva }}, {{ p.fecha|fecha_es }}
            {% else %}
               {{ p.fecha|fecha_es }}

            {% endif %}
          </div>


        </div>
      </div>
    {% endfor %}
  </div>
</div>
{% endif %}


{% if procesion_destacada %}
<div class="container my-4">
  <div class="featured-procession shadow-sm">  {# <-- NUEVO wrapper #}
    <div class="featured-procession__media">
      {% if procesion_destacada.imagen_promocional %}
        <img src="{{ procesion_destacada.imagen_promocional.url }}" alt="{{ procesion_destacada.nombre }}">
      {% else %}
        <img src="{% static 'img/procesiones/procesion_destacada.jpg' %}" alt="{{ procesion_destacada.nombre }}">
      {% endif %}

      <div class="featured-procession__overlay"></div>

      <div class="featured-procession__top">

      </div>

      <div class="featured-procession__content">
        <div>
          <h3 class="featured-procession__title mb-1">{{ procesion_destacada.nombre }}</h3>

          {% if procesion_destacada.descripcion %}
            <p class="featured-procession__desc mb-2">{{ procesion_destacada.descripcion }}</p>
          {% endif %}

          <div class="featured-procession__meta">
            <span class="me-3">
              <i class="bx bx-calendar me-1"></i>
              {{ procesion_destacada.fecha|date:"d/m/Y" }}
            </span>
          </div>
        </div>

        <a href="{% url 'inscripciones_online:inscripcion_online' procesion_destacada.id %}"
           class="btn btn-primary btn-lg featured-procession__btn">
          <i class="bx bx-check-circle me-1"></i> Inscribirse ahora
        </a>
      </div>

    </div>
  </div>
</div>
{% endif %}




{% endblock %}

{% block extra_js %}

<script src="https://unpkg.com/swiper@10/swiper-bundle.min.js"></script>
<script>
 // Índice del slide "¿QUIÉNES SOMOS?" en tu HTML (es el primero)
  const START_INDEX = 0;

  const featureSwiper = new Swiper('.feature-swiper', {
    init: false,                 // ← iniciamos manualmente
    loop: true,
    grabCursor: true,
    watchOverflow: true,
    slidesPerView: 1.05,
    centeredSlides: true,        // móvil
    spaceBetween: 16,
    pagination: { el: '.feature-swiper .swiper-pagination', clickable: true },
    navigation: {
      nextEl: '.feature-swiper-outer .swiper-button-next',
      prevEl: '.feature-swiper-outer .swiper-button-prev',
    },
    breakpoints: {
      576:  { slidesPerView: 1.3, centeredSlides: false, spaceBetween: 20 },
      768:  { slidesPerView: 2,   centeredSlides: false, spaceBetween: 24 },
      1200: { slidesPerView: 3,   centeredSlides: false, spaceBetween: 24 }
    }
  });

  // Asegura el inicio en "¿QUIÉNES SOMOS?" con loop activo
  featureSwiper.on('init', () => {
    featureSwiper.slideToLoop(START_INDEX, 0, false);
  });

  featureSwiper.init();

  // (Opcional) si el usuario rota el dispositivo o cambia el tamaño, re-enfoca
  window.addEventListener('resize', () => {
    featureSwiper.slideToLoop(START_INDEX, 0, false);
  });
</script>
<script>
    function mostrarInformacion() {
        Swal.fire({
            title: "¿Quiénes somos?",
            text: "Información sobre nuestra iglesia y comunidad. Nuestra misión es promover la fe y la unión espiritual.",
            icon: "info",
            confirmButtonText: "Cerrar"
        });
    }
</script>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'home/css/home.css' %}">

{% endblock %}
